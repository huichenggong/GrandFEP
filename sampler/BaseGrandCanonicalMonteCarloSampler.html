<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>BaseGrandCanonicalMonteCarloSampler &#8212; GrandFEP  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=fd3c8104" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NoneqGrandCanonicalMonteCarloSampler" href="NoneqGrandCanonicalMonteCarloSampler.html" />
    <link rel="prev" title="sampler" href="../sampler.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">GrandFEP</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=huichenggong&repo=GrandFEP&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">GrandFEP API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../sampler.html">sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commandline.html">GrandFEP CLI</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../modules.html">GrandFEP API</a><ul>
  <li><a href="../sampler.html">sampler</a><ul>
      <li>Previous: <a href="../sampler.html" title="previous chapter">sampler</a></li>
      <li>Next: <a href="NoneqGrandCanonicalMonteCarloSampler.html" title="next chapter">NoneqGrandCanonicalMonteCarloSampler</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="basegrandcanonicalmontecarlosampler">
<h1>BaseGrandCanonicalMonteCarloSampler<a class="headerlink" href="#basegrandcanonicalmontecarlosampler" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">grandfep.sampler.</span></span><span class="sig-name descname"><span class="pre">BaseGrandCanonicalMonteCarloSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collision_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform=&lt;openmm.openmm.Platform;</span> <span class="pre">proxy</span> <span class="pre">of</span> <span class="pre">&lt;Swig</span> <span class="pre">Object</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">'OpenMM::Platform</span> <span class="pre">*'&gt;</span> <span class="pre">&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_resname='HOH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_O_name='O'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_simulation=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization='O3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_water='log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for Grand Canonical Monte Carlo (GCMC) sampling.</p>
<p>This class provides a flexible framework for customizing OpenMM forces so that water molecules
can be alchemically inserted (ghost → real) or deleted (real → ghost). Each water is assigned two properties:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>is_real</cite>:</dt><dd><ul>
<li><p>1.0 : real water</p></li>
<li><p>0.0 : ghost water.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>is_switching</cite>:</dt><dd><ul>
<li><p>1.0 for the switching water (used for NEQ insertion/deletion)</p></li>
<li><p>0.0 for all other waters.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The last water in the system is selected as the switching water (is_real=1, is_switching=1).
During an insertion or deletion attempt, this water is swapped (coordinate and velocity)
with a ghost or real water, enabling NEQ perturbation moves.</p>
<p>vdW interactions are handled via <cite>self.custom_nonbonded_force</cite> (<cite>openmm.CustomNonbondedForce</cite>), where
per-particle parameters <cite>is_real</cite> and <cite>is_switching</cite> interact with the global parameter <code class="docutils literal notranslate"><span class="pre">lambda_gc_vdw</span></code>.</p>
<p>Electrostatic interactions are handled by <cite>self.nonbonded_force</cite> (<cite>openmm.NonbondedForce</cite>). Ghost waters
are given zero charge, and switching waters use <cite>ParticleParameterOffset</cite> with a global parameter
<code class="docutils literal notranslate"><span class="pre">lambda_gc_coulomb</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_particle_parameter_index_cust_nb_force">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_particle_parameter_index_cust_nb_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_nonbonded_force</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_particle_parameter_index_cust_nb_force" title="Link to this definition">¶</a></dt>
<dd><p>Get the indices of <cite>is_real</cite> and <cite>is_switching</cite> parameters in the perParticleParameters
of <cite>self.custom_nonbonded_force</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>custom_nonbonded_force</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.CustomNonbondedForce</span></code></span>) – The CustomNonbondedForce to be checked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <cite>(is_real_index, is_switching_index)</cite> indicating the indices of the corresponding
parameters in <cite>self.custom_nonbonded_force.getPerParticleParameterName(i)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collision_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform=&lt;openmm.openmm.Platform;</span> <span class="pre">proxy</span> <span class="pre">of</span> <span class="pre">&lt;Swig</span> <span class="pre">Object</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">'OpenMM::Platform</span> <span class="pre">*'&gt;</span> <span class="pre">&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_resname='HOH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_O_name='O'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_simulation=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization='O3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_water='log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></span>) – The OpenMM System object. Must include <cite>CustomNonbondedForce</cite> and <cite>NonbondedForce</cite> with
appropriate per-particle parameters and global parameter definitions.</p></li>
<li><p><strong>topology</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.app.topology.Topology</span></code></span>) – The OpenMM Topology object. Must contain water molecules with the specified residue and atom names.</p></li>
<li><p><strong>temperature</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></span>) – The reference temperature for the system, with proper units (e.g., kelvin).</p></li>
<li><p><strong>collision_rate</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></span>) – The collision rate (friction) for the Langevin integrator, with time units.</p></li>
<li><p><strong>timestep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></span>) – The timestep for the integrator, with time units (e.g., femtoseconds).</p></li>
<li><p><strong>log</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code>]</span>) – Path to the log file. This file will be opened in append mode.</p></li>
<li><p><strong>platform</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.Platform</span></code></span>) – The OpenMM computational platform to use. Default is CUDA.</p></li>
<li><p><strong>water_resname</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The residue name of water in the topology. Default is ‘HOH’.</p></li>
<li><p><strong>water_O_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The atom name of oxygen in water. Default is ‘O’.</p></li>
<li><p><strong>create_simulation</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to create a system inside this class. When you only want to customize the system using this class,
you can set this to False, in order to avoid unnecessary memory usage.</p></li>
<li><p><strong>optimization</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'O3'</span></code>, <code class="docutils literal notranslate"><span class="pre">'O1'</span></code>]</span>) – The optimization level for this system. Options are ‘O1’ and ‘O3’. Default is ‘O3’. In ‘O3’, we will try to
hardcode water-water vdw if only Oxygen has vdw parameters.</p></li>
<li><p><strong>n_split_water</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – Number of split water for Hybrid_REST2 system. If ‘log’, will use log10(N_water).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.check_ghost_list">
<span class="sig-name descname"><span class="pre">check_ghost_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.check_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Loop over all water particles in the system to validate that <cite>self.ghost_list</cite> correctly reflects
the current ghost and switching water configuration.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Ghost water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 0.0</cite> and <cite>is_switching = 0.0</cite> in every CustomNonbondedForce in <cite>self.custom_nonbonded_force_dict</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Real and not switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> in every CustomNonbondedForce in <cite>self.custom_nonbonded_force_dict</cite></p></li>
<li><p>Charge = Proper_water_charge in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> in every CustomNonbondedForce in <cite>self.custom_nonbonded_force_dict</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<p>The switching water should not be present in <cite>self.ghost_list</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any condition for ghost, real, or switching water is violated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.check_switching">
<span class="sig-name descname"><span class="pre">check_switching</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.check_switching" title="Link to this definition">¶</a></dt>
<dd><p>Loop over all water particles in the system to make sure the one water given by self.switching_water is the
only one that is switching.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> and <cite>is_switching = 1.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite> (ParticleParameters)</p></li>
<li><p><cite>chargeScale = proper_water_charge</cite> in <cite>ParticleParameterOffsets</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Non-switching waters:</dt><dd><ol class="arabic simple">
<li><p><cite>is_switching = 0.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>No <cite>ParticleParameterOffsets</cite> in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any switching or non-switching water fails to meet the expected criteria.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_amber">
<span class="sig-name descname"><span class="pre">customise_force_amber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_amber" title="Link to this definition">¶</a></dt>
<dd><p>In Amber, NonbondedForce handles both electrostatics and vdW. This function will remove vdW from NonbondedForce
and create a list of CustomNonbondedForce (in this case, only 1 in the list) to handle vdW, so that the
interaction can be switched off for certain water.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></span>) – openmm.System
The system to be converted.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_charmm">
<span class="sig-name descname"><span class="pre">customise_force_charmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_charmm" title="Link to this definition">¶</a></dt>
<dd><p>In Charmm, NonbondedForce handles electrostatics, and CustomNonbondedForce handles vdW. For vdW, this function will add
perParticle parameters ‘is_real’, ‘is_switching’, global parameter <code class="docutils literal notranslate"><span class="pre">lambda_gc_vdw</span></code> to the CustomNonbondedForce.
For Coulomb, this function will add ParticleParameterOffset to the switching water and <code class="docutils literal notranslate"><span class="pre">lambda_gc_coulomb</span></code>
to the NonbondedForce.</p>
<dl class="simple">
<dt>The CustomNonbondedForce should have the following energy expression:</dt><dd><p>‘(a/r6)^2-b/r6; r6=r^6;a=acoef(type1, type2);b=bcoef(type1, type2)’
or
‘acoef(type1, type2)/r^12 - bcoef(type1, type2)/r^6;’</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></span>) – openmm.System
The system to be converted.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_hybrid">
<span class="sig-name descname"><span class="pre">customise_force_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_hybrid" title="Link to this definition">¶</a></dt>
<dd><p>If the system is Hybrid, this function will add perParticleParameters <code class="docutils literal notranslate"><span class="pre">is_real</span></code> and <code class="docutils literal notranslate"><span class="pre">is_switching</span></code>
to the custom_nonbonded_force (openmm.openmm.CustomNonbondedForce) for vdw.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Groups</p></th>
<th class="head"><p>old</p></th>
<th class="head"><p>core</p></th>
<th class="head"><p>new</p></th>
<th class="head"><p>fix</p></th>
<th class="head"><p>wat</p></th>
<th class="head"><p>swit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>old</p></td>
<td><p>C1</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>core</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>new</p></td>
<td><p>None</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>fix</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C4</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>wat</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C3</p></td>
<td><p>C3</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>swit</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C1</p></td>
<td><p>C2</p></td>
<td><p>C2</p></td>
<td><p>C2</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></span>) – The system to be converted.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_hybridREST2">
<span class="sig-name descname"><span class="pre">customise_force_hybridREST2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.customise_force_hybridREST2" title="Link to this definition">¶</a></dt>
<dd><p>If the system is Hybrid, this function will add perParticleParameters <code class="docutils literal notranslate"><span class="pre">is_real</span></code> and <code class="docutils literal notranslate"><span class="pre">is_switching</span></code>
to the custom_nonbonded_force (openmm.openmm.CustomNonbondedForce) for vdw.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Groups</p></th>
<th class="head"><p>core</p></th>
<th class="head"><p>new</p></th>
<th class="head"><p>old</p></th>
<th class="head"><p>envh</p></th>
<th class="head"><p>envc</p></th>
<th class="head"><p>wat</p></th>
<th class="head"><p>swit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 core</p></td>
<td><p>C_alc</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1 new</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>2 old</p></td>
<td><p>C_alc</p></td>
<td><p>None</p></td>
<td><p>C_alc</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3 envh</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>NonB</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4 envc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>NonB</p></td>
<td><p>NonB</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5 wat</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_wat1</p></td>
<td><p>C_wat2</p></td>
<td><p>C_wat3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6 swit</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
<td><p>C_alc</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><dl class="simple">
<dt>C_alc</dt><dd><p>CustomNonbondedForce for Alchemical atoms</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>C_wat1</dt><dd><p>CustomNonbondedForce for</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>C_wat2</dt><dd><p>CustomNonbondedForce for</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>C_wat3</dt><dd><p>CustomNonbondedForce for</p>
</dd>
</dl>
</li>
</ul>
<p>The most basic energy expression for vdw is the following. All the other forces are simplified from this one.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">energy</span>  <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 2</span>    <span class="s2">&quot;U_rest2;&quot;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>    <span class="c1"># 9. REST2</span>
<span class="linenos"> 5</span>    <span class="s2">&quot;U_rest2 = U_sterics * k_rest2_sqrt^is_hot;&quot;</span>
<span class="linenos"> 6</span>    <span class="s2">&quot;is_hot = step(3-atom_group1) + step(3-atom_group2);&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="c1"># 8. vdw with 1. switching water 2. water real/dummy</span>
<span class="linenos"> 9</span>    <span class="s2">&quot;U_sterics = 4*epsilon*x*(x-1.0) * lambda_gc * is_real1 * is_real2;&quot;</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># 7. introduce softcore when new/old/switching atoms are involved</span>
<span class="linenos">12</span>    <span class="s2">&quot;x = 1 / ((softcore_alpha*lambda_alpha + (r/sigma)^6));&quot;</span>
<span class="linenos">13</span>    <span class="s2">&quot;lambda_alpha = (new_X*(1-lambda_sterics_insert) + old_X*lambda_sterics_delete + swit_X*lambda_gc_vdw) / (swit_X + 1);&quot;</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="c1"># 6. Interpolating between states A and B</span>
<span class="linenos">16</span>    <span class="s2">&quot;epsilon = (1-lambda_sterics)*epsilonA + lambda_sterics*epsilonB;&quot;</span>
<span class="linenos">17</span>    <span class="s2">&quot;sigma = (1-lambda_sterics)*sigmaA + lambda_sterics*sigmaB;&quot;</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    <span class="c1"># 5. select lambda</span>
<span class="linenos">20</span>    <span class="s2">&quot;lambda_sterics = (new_X*lambda_sterics_insert + old_X*lambda_sterics_delete + core_cew*lambda_sterics_core);&quot;</span> <span class="c1"># only one lambda_XXX will take effect</span>
<span class="linenos">21</span>    <span class="s2">&quot;lambda_gc = ((1 - swit_X) + lambda_gc_vdw * swit_X);&quot;</span> <span class="c1"># if swit_X=0 -&gt; lambda_gc=1, if swit_X=1 -&gt; lambda_gc=lambda_gc_vdw</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    <span class="c1"># 4. determine interaction types</span>
<span class="linenos">24</span>    <span class="s2">&quot;swit_X   = max(is_swit1, is_swit2);&quot;</span>
<span class="linenos">25</span>    <span class="s2">&quot;core_cew = delta(old_X + new_X);&quot;</span>    <span class="c1"># core-core + core-envh + core-envc + core-wat + core-swit</span>
<span class="linenos">26</span>    <span class="s2">&quot;new_X    = max(is_new1, is_new2);&quot;</span>
<span class="linenos">27</span>    <span class="s2">&quot;old_X    = max(is_old1, is_old2);&quot;</span>
<span class="linenos">28</span>
<span class="linenos">29</span>    <span class="c1"># 3. determine atom groups</span>
<span class="linenos">30</span>    <span class="c1">## 3.1 check atom1</span>
<span class="linenos">31</span>    <span class="s2">&quot;is_core1 = delta(0-atom_group1);&quot;</span>
<span class="linenos">32</span>    <span class="s2">&quot;is_new1  = delta(1-atom_group1);&quot;</span>
<span class="linenos">33</span>    <span class="s2">&quot;is_old1  = delta(2-atom_group1);&quot;</span>
<span class="linenos">34</span>    <span class="s2">&quot;is_envh1 = delta(3-atom_group1);&quot;</span>
<span class="linenos">35</span>    <span class="s2">&quot;is_envc1 = delta(4-atom_group1);&quot;</span>
<span class="linenos">36</span>    <span class="s2">&quot;is_wat1  = delta(5-atom_group1);&quot;</span>
<span class="linenos">37</span>    <span class="s2">&quot;is_swit1 = delta(6-atom_group1);&quot;</span>
<span class="linenos">38</span>    <span class="c1">## 3.2 check atom2</span>
<span class="linenos">39</span>    <span class="s2">&quot;is_core2 = delta(0-atom_group2);&quot;</span>
<span class="linenos">40</span>    <span class="s2">&quot;is_new2  = delta(1-atom_group2);&quot;</span>
<span class="linenos">41</span>    <span class="s2">&quot;is_old2  = delta(2-atom_group2);&quot;</span>
<span class="linenos">42</span>    <span class="s2">&quot;is_envh2 = delta(3-atom_group2);&quot;</span>
<span class="linenos">43</span>    <span class="s2">&quot;is_envc2 = delta(4-atom_group2);&quot;</span>
<span class="linenos">44</span>    <span class="s2">&quot;is_wat2  = delta(5-atom_group2);&quot;</span>
<span class="linenos">45</span>    <span class="s2">&quot;is_swit2 = delta(6-atom_group2);&quot;</span>
<span class="linenos">46</span>
<span class="linenos">47</span>    <span class="c1"># 1. LJ mixing rules</span>
<span class="linenos">48</span>    <span class="s2">&quot;epsilonA = sqrt(epsilonA1*epsilonA2);&quot;</span>
<span class="linenos">49</span>    <span class="s2">&quot;epsilonB = sqrt(epsilonB1*epsilonB2);&quot;</span>
<span class="linenos">50</span>    <span class="s2">&quot;sigmaA = 0.5*(sigmaA1 + sigmaA2);&quot;</span>
<span class="linenos">51</span>    <span class="s2">&quot;sigmaB = 0.5*(sigmaB1 + sigmaB2);&quot;</span>
<span class="linenos">52</span>    <span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></span>) – The system to be converted.</p></li>
<li><p><strong>optimization</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'O3'</span></code>, <code class="docutils literal notranslate"><span class="pre">'O1'</span></code>]</span>) – Level of optimization. It can be <cite>O3</cite> or <cite>O1</cite>. When <cite>O3</cite> is selected, We will try to hard code sigma and epsilon
into the energy expression for wat-wat interaction if there is only one water atom has LJ. This can be applied to
TIP3P, OPC. <cite>O3</cite> will make no difference if charmm TIP3P is used, because H also has LJ parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_ghost_list">
<span class="sig-name descname"><span class="pre">get_ghost_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Get a copy of the current ghost water list.</p>
<p>If <cite>check_system</cite> is True, <cite>self.check_ghost_list</cite> will be called to validate the consistency of self.ghost_list
with <cite>self.custom_nonbonded_force</cite> and <cite>self.nonbonded_force</cite>. If the validation fails,
a ValueError will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>check_system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If True, self.check_ghost_list() will be called to perform consistency checks in the system forces
to ensure that the ghost list is correct.
Default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of <cite>self.ghost_list</cite>, which contains the residue indices of ghost waters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_particle_parameter_offset_dict">
<span class="sig-name descname"><span class="pre">get_particle_parameter_offset_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.get_particle_parameter_offset_dict" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve all <cite>ParticleParameterOffset</cite> entries from <cite>self.nonbonded_force</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dictionary mapping atom indices to their corresponding <cite>ParticleParameterOffset</cite> data.</p>
<p>The key is the atom index. Each value is a list with the following structure:
[
param_offset_index,
global_parameter_name,
atom_index,
chargeScale,
sigmaScale,
epsilonScale
]</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.set_ghost_list">
<span class="sig-name descname"><span class="pre">set_ghost_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ghost_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.set_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Update the water residues in <cite>ghost_list</cite> to ghost.</p>
<p>If <cite>check_system</cite> is True, <cite>self.check_ghost_list</cite> will be called to validate the consistency of self.ghost_list
with <cite>self.custom_nonbonded_force_list</cite> and <cite>self.nonbonded_force</cite>. If the validation fails,
a ValueError will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ghost_list</strong> (<em>list</em>) – A list of residue indices (integers) that should be marked as ghost waters.</p></li>
<li><p><strong>check_system</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform validation to ensure the internal force parameters are consistent with
the updated <cite>ghost_list</cite>. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.Adam_GCMC">
<span class="sig-name descname"><span class="pre">Adam_GCMC</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.Adam_GCMC" title="Link to this definition">¶</a></dt>
<dd><p>Adam value, considering the selected sphere and water molecules in the sphere.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.Adam_box">
<span class="sig-name descname"><span class="pre">Adam_box</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.Adam_box" title="Link to this definition">¶</a></dt>
<dd><p>Adam value, considering the whole simulation box and all water molecules.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.compound_integrator">
<span class="sig-name descname"><span class="pre">compound_integrator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.CompoundIntegrator</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.compound_integrator" title="Link to this definition">¶</a></dt>
<dd><p>2 integrators in this attribute. The 1st one is for Canonical simulation, the 2nd one is for non-equilibirum insertion/deletion.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.ghost_list">
<span class="sig-name descname"><span class="pre">ghost_list</span></span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>A list of residue indices of water that are set to ghost. Should only be modified with set_ghost_list(), and get by get_ghost_list().</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.kBT">
<span class="sig-name descname"><span class="pre">kBT</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.kBT" title="Link to this definition">¶</a></dt>
<dd><p>k<sub>B</sub>* T, with unit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.logger" title="Link to this definition">¶</a></dt>
<dd><p>Logger for the Sampler</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.nonbonded_force">
<span class="sig-name descname"><span class="pre">nonbonded_force</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.NonbondedForce</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.nonbonded_force" title="Link to this definition">¶</a></dt>
<dd><p>This force handles Coulomb. The switching water has ParticleParameterOffset with global parameter
<code class="docutils literal notranslate"><span class="pre">lambda_gc_coulomb</span></code> to control the switching water.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.num_of_points_water">
<span class="sig-name descname"><span class="pre">num_of_points_water</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.num_of_points_water" title="Link to this definition">¶</a></dt>
<dd><p>The number of points in the water model. 3 for TIP3P, 4 for OPC.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.simulation">
<span class="sig-name descname"><span class="pre">simulation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.app.simulation.Simulation</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.simulation" title="Link to this definition">¶</a></dt>
<dd><p>Simulation ties together Topology, System, Integrator, and Context in this sampler.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.switching_water">
<span class="sig-name descname"><span class="pre">switching_water</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.switching_water" title="Link to this definition">¶</a></dt>
<dd><p>The residue index of the switching water. The switching water will be set as the last water during initialization.
It should not be changed during the simulation, as the ParticleParameterOffset can not be updated in NonbondedForce.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.system">
<span class="sig-name descname"><span class="pre">system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.openmm.System</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.system" title="Link to this definition">¶</a></dt>
<dd><p>The OpenMM System object.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.system_type">
<span class="sig-name descname"><span class="pre">system_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.system_type" title="Link to this definition">¶</a></dt>
<dd><p>The type of the system. Can be Amber, Charmm or Hybrid depending on the system and energy expression in the given CustomNonbondedForce.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.temperature">
<span class="sig-name descname"><span class="pre">temperature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.unit.quantity.Quantity</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.temperature" title="Link to this definition">¶</a></dt>
<dd><p>The reference temperature for the system, with proper units (e.g., kelvin).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.topology">
<span class="sig-name descname"><span class="pre">topology</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">openmm.app.topology.Topology</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.topology" title="Link to this definition">¶</a></dt>
<dd><p>The OpenMM Topology object. All the res_name, atom_index, atom_name, etc. are in this topology.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.wat_params">
<span class="sig-name descname"><span class="pre">wat_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.wat_params" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary to track the nonbonded parameter of water. The keys are <code class="docutils literal notranslate"><span class="pre">charge</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span></code>, <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>,
The values are a list of parameters with unit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.water_res_2_O">
<span class="sig-name descname"><span class="pre">water_res_2_O</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.water_res_2_O" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of residue index to the atom index of water oxygen.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.water_res_2_atom">
<span class="sig-name descname"><span class="pre">water_res_2_atom</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler.water_res_2_atom" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of residue index to a list of atom indices of water.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Chenggong Hui.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/sampler/BaseGrandCanonicalMonteCarloSampler.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/huichenggong/GrandFEP" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>