<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NoneqGrandCanonicalMonteCarloSampler &#8212; GrandFEP  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=3f530b75" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=fd3c8104" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="utils" href="../utils.html" />
    <link rel="prev" title="BaseGrandCanonicalMonteCarloSampler" href="BaseGrandCanonicalMonteCarloSampler.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">GrandFEP</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=huichenggong&repo=GrandFEP&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">GrandFEP API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../sampler.html">sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commandline.html">GrandFEP CLI</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../modules.html">GrandFEP API</a><ul>
  <li><a href="../sampler.html">sampler</a><ul>
      <li>Previous: <a href="BaseGrandCanonicalMonteCarloSampler.html" title="previous chapter">BaseGrandCanonicalMonteCarloSampler</a></li>
      <li>Next: <a href="../utils.html" title="next chapter">utils</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="noneqgrandcanonicalmontecarlosampler">
<h1>NoneqGrandCanonicalMonteCarloSampler<a class="headerlink" href="#noneqgrandcanonicalmontecarlosampler" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">grandfep.sampler.</span></span><span class="sig-name descname"><span class="pre">NoneqGrandCanonicalMonteCarloSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collision_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">platform=&lt;openmm.openmm.Platform;</span> <span class="pre">proxy</span> <span class="pre">of</span> <span class="pre">&lt;Swig</span> <span class="pre">Object</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">'OpenMM::Platform</span> <span class="pre">*'&gt;</span> <span class="pre">&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_resname='HOH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_O_name='O'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemical_potential=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standard_volume=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere_radius=Quantity(value=10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit=angstrom)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_atoms=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="BaseGrandCanonicalMonteCarloSampler.html#grandfep.sampler.BaseGrandCanonicalMonteCarloSampler" title="grandfep.sampler.base.BaseGrandCanonicalMonteCarloSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGrandCanonicalMonteCarloSampler</span></code></a></p>
<p>Nonequilibrium Grand Canonical Monte Carlo (Noneq-GCMC) sampler.</p>
<p>In this class, GCMC is achieved by performing insertion/deletion in a nonequilibrium candidate Monte Carlo manner.
The work value of the insertion/deletion will be used to evaluate the acceptance ratio. Insertion/deletion can
either be performed in the whole box or in a sub-volume (active site) of the box. In an equilibrium sampling, when
the water is free to move in/out of the sub-volume, I recommend alternating between GCMC and box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></span>) – The OpenMM System object. Must include <cite>CustomNonbondedForce</cite> and <cite>NonbondedForce</cite> with
appropriate per-particle parameters and global parameter definitions.</p></li>
<li><p><strong>topology</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></span>) – The OpenMM Topology object. Must contain water molecules with the specified residue and atom names. Must have
the correct boxVector. Only rectangular box is supported.</p></li>
<li><p><strong>temperature</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span>) – The reference temperature for the system, with proper units (e.g., kelvin).</p></li>
<li><p><strong>collision_rate</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span>) – The collision rate (friction) for the Langevin integrator, with time units.</p></li>
<li><p><strong>timestep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span>) – The timestep for the integrator, with time units (e.g., femtoseconds).</p></li>
<li><p><strong>log</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</span>) – Path to the log file. This file will be opened in appended mode.</p></li>
<li><p><strong>platform</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Platform</span></code></span>) – The OpenMM computational platform to use. Default is CUDA.</p></li>
<li><p><strong>water_resname</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The residue name of water in the topology. Default is ‘HOH’.</p></li>
<li><p><strong>water_O_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The atom name of oxygen in water. Default is ‘O’.</p></li>
<li><p><strong>position</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span>) – Initial position of the system. Need to be provided for box Vectors. Default is None.</p></li>
<li><p><strong>chemical_potential</strong> – Chemical potential of the system. with units. Default is None.</p></li>
<li><p><strong>standard_volume</strong> – Standard volume of a water molecule in the reservoir. with units. Default is None.</p></li>
<li><p><strong>sphere_radius</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span>) – Radius of the GCMC sphere. Default is 10.0 * unit.angstroms.</p></li>
<li><p><strong>reference_atoms</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></span>) – A list of atom indices in the topology that will be set as the center of the GCMC sphere. Default is None.</p></li>
</ul>
</dd>
</dl>
<section id="additional-attributes">
<h2>Additional Attributes<a class="headerlink" href="#additional-attributes" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>gc_count<span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Dictionary to keep track of the GCMC moves. The keys are:</dt><dd><ul class="simple">
<li><p>current_move: (int) the current move number</p></li>
<li><p>move: (list) list of move numbers</p></li>
<li><p>insert_delete: (list) list of 0/1 for insertion/deletion</p></li>
<li><p>work: (list) list of work values. In the unit of kcal/mol</p></li>
<li><p>box_GCMC: (list) list of 0/1 for box/GCMC</p></li>
<li><p>N: (list) list of number of water molecules in the box or GCMC sub-volume</p></li>
<li><p>accept: (list) list of 0/1 for rejection/acceptance</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>chemical_potential<span class="classifier">unit.Quantity</span></dt><dd><p>Chemical potential of the system.</p>
</dd>
<dt>standard_volume<span class="classifier">unit.Quantity</span></dt><dd><p>Standard volume of a water molecule in the reservoir.</p>
</dd>
<dt>reference_atoms<span class="classifier">list</span></dt><dd><p>A list of atom indices in the topology that will be set as the center of the GCMC sphere.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.check_ghost_list">
<span class="sig-name descname"><span class="pre">check_ghost_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.check_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Loop over all water particles in the system to validate that <cite>self.ghost_list</cite> correctly reflects
the current ghost and switching water configuration.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Ghost water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 0.0</cite> and <cite>is_switching = 0.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Real and not switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>Charge = Proper_water_charge in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<p>The switching water should not be present in <cite>self.ghost_list</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any condition for ghost, real, or switching water is violated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.check_switching">
<span class="sig-name descname"><span class="pre">check_switching</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.check_switching" title="Link to this definition">¶</a></dt>
<dd><p>Loop over all water particles in the system to make sure the one water given by self.switching_water is the
only one that is switching.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Switching water:</dt><dd><ol class="arabic simple">
<li><p><cite>is_real = 1.0</cite> and <cite>is_switching = 1.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>Charge = 0.0 in <cite>self.nonbonded_force</cite> (ParticleParameters)</p></li>
<li><p><cite>chargeScale = proper_water_charge</cite> in <cite>ParticleParameterOffsets</cite></p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Non-switching waters:</dt><dd><ol class="arabic simple">
<li><p><cite>is_switching = 0.0</cite> in <cite>self.custom_nonbonded_force</cite></p></li>
<li><p>No <cite>ParticleParameterOffsets</cite> in <cite>self.nonbonded_force</cite></p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any switching or non-switching water fails to meet the expected criteria.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.deletion_move_GCMC">
<span class="sig-name descname"><span class="pre">deletion_move_GCMC</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.deletion_move_GCMC" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.deletion_move_box">
<span class="sig-name descname"><span class="pre">deletion_move_box</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.deletion_move_box" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.gcmc_move">
<span class="sig-name descname"><span class="pre">gcmc_move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.gcmc_move" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_ghost_list">
<span class="sig-name descname"><span class="pre">get_ghost_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Get a copy of the current ghost water list.</p>
<p>If <cite>check_system</cite> is True, <cite>self.check_ghost_list</cite> will be called to validate the consistency of self.ghost_list
with <cite>self.custom_nonbonded_force</cite> and <cite>self.nonbonded_force</cite>. If the validation fails,
a ValueError will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>check_system</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If True, self.check_ghost_list() will be called to perform consistency checks in the system forces
to ensure that the ghost list is correct.
Default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of <cite>self.ghost_list</cite>, which contains the residue indices of ghost waters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_particle_parameter_index_cust_nb_force">
<span class="sig-name descname"><span class="pre">get_particle_parameter_index_cust_nb_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_particle_parameter_index_cust_nb_force" title="Link to this definition">¶</a></dt>
<dd><p>Get the indices of <cite>is_real</cite> and <cite>is_switching</cite> parameters in the perParticleParameters
of <cite>self.custom_nonbonded_force</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(is_real_index, is_switching_index)</cite> indicating the indices of the corresponding
parameters in <cite>self.custom_nonbonded_force.getPerParticleParameterName(i)</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_particle_parameter_offset_dict">
<span class="sig-name descname"><span class="pre">get_particle_parameter_offset_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.get_particle_parameter_offset_dict" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve all <cite>ParticleParameterOffset</cite> entries from <cite>self.nonbonded_force</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dictionary mapping atom indices to their corresponding <cite>ParticleParameterOffset</cite> data.</p>
<p>The key is the atom index. Each value is a list with the following structure:
[
param_offset_index,
global_parameter_name,
atom_index,
chargeScale,
sigmaScale,
epsilonScale
]</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.insertion_move_GCMC">
<span class="sig-name descname"><span class="pre">insertion_move_GCMC</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.insertion_move_GCMC" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.insertion_move_box">
<span class="sig-name descname"><span class="pre">insertion_move_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_vdw_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_coulomb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_prop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.insertion_move_box" title="Link to this definition">¶</a></dt>
<dd><p>Perform a non-equilibrium insertion. The vdw will be turned on first, followed by coulomb</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_vdw_list</strong> (<em>list</em>) – A list of <code class="docutils literal notranslate"><span class="pre">lambda_gc_vdw</span></code> value that defines the path of insertion</p></li>
<li><p><strong>l_coulomb_list</strong> (<em>list</em>) – A list of <code class="docutils literal notranslate"><span class="pre">lambda_gc_coulomb</span></code> value that defines the path of insertion</p></li>
<li><p><strong>n_prop</strong> (<em>int</em>) – Number of propergation step (equlibrium MD) between each lambda switching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>positions</strong> (<em>unit.Quantity</em>) – Positions after this GCMC move.</p></li>
<li><p><strong>velocities</strong> (<em>unit.Quantity</em>) – Velocities after this GCMC move.</p></li>
<li><p><strong>work</strong> (<em>unit.Quantity</em>) – Work during the insertion process.</p></li>
<li><p><strong>accept</strong> (<em>bool</em>) – Whether the insertion move was accepted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.random_place_water">
<span class="sig-name descname"><span class="pre">random_place_water</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.random_place_water" title="Link to this definition">¶</a></dt>
<dd><p>Shift the coordinate+orientation of a water molecule to a random place. If the center is None, a random position
in the box will be selected. If the center is not None, a randomed position in the GCMC sphere will be selected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>openmm.State</em>) – The current state of the simulation context. The positions will be read from this state.</p></li>
<li><p><strong>res_index</strong> (<em>int</em>) – The residue index of the water molecule to be shifted.</p></li>
<li><p><strong>sphere_center</strong> (<em>unit.Quantity</em>) – The center of the GCMC sphere. If None, a random position in the box will be selected. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>positions</strong> (<em>unit.Quantity</em>) – The new positions with the water molecule shifted.</p></li>
<li><p><strong>velocities</strong> (<em>unit.Quantity</em>) – The new velocities with the water molecule shifted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">write_dcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.report" title="Link to this definition">¶</a></dt>
<dd><p>Report the GC moves and write trajectory if needed.
:type write_dcd: 
:param write_dcd:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.set_ghost_list">
<span class="sig-name descname"><span class="pre">set_ghost_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ghost_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.set_ghost_list" title="Link to this definition">¶</a></dt>
<dd><p>Update the water residues in <cite>ghost_list</cite> to ghost.</p>
<p>If <cite>check_system</cite> is True, <cite>self.check_ghost_list</cite> will be called to validate the consistency of self.ghost_list
with <cite>self.custom_nonbonded_force</cite> and <cite>self.nonbonded_force</cite>. If the validation fails,
a ValueError will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ghost_list</strong> (<em>list</em>) – A list of residue indices (integers) that should be marked as ghost waters.</p></li>
<li><p><strong>check_system</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform validation to ensure the internal force parameters are consistent with
the updated <cite>ghost_list</cite>. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.update_gc_count">
<span class="sig-name descname"><span class="pre">update_gc_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">insert_delete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_GCMC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_water</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#grandfep.sampler.NoneqGrandCanonicalMonteCarloSampler.update_gc_count" title="Link to this definition">¶</a></dt>
<dd><p>Update the internal <cite>gc_count</cite> dictionary that tracks GCMC insertion/deletion statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>insert_delete</strong> (<em>int</em>) – Indicator for the type of move: <cite>0</cite> for insertion, <cite>1</cite> for deletion.</p></li>
<li><p><strong>work</strong> (<em>unit.Quantity</em>) – Work value (e.g., from nonequilibrium switching), with units. The value in kcal/mol will be recorded.</p></li>
<li><p><strong>box_GCMC</strong> (<em>int</em>) – Region type indicator: <cite>0</cite> for the whole simulation box, <cite>1</cite> for a GCMC sub-volume.</p></li>
<li><p><strong>n_water</strong> (<em>int</em>) – Number of water molecules in the whole box or in the GCMC sub-volume, depending on <cite>box_GCMC</cite>.</p></li>
<li><p><strong>accept</strong> (<em>int</em>) – Indicator of whether the move was accepted: <cite>1</cite> for accepted, <cite>0</cite> for rejected.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Chenggong Hui.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/sampler/NoneqGrandCanonicalMonteCarloSampler.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/huichenggong/GrandFEP" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>